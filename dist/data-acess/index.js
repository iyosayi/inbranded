"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.makeDb = makeDb;

var _mongodb = require("mongodb");

require('dotenv').config();

const dbName = process.env.DB_NAME;
const url = process.env.DB_URL_LIVE || process.env.DB_LOCAL_URL; // @ts-ignore

const client = new _mongodb.MongoClient(url, {
  useNewUrlParser: true,
  useUnifiedTopology: true
});

async function makeDb() {
  if (!client.isConnected()) {
    await client.connect();
  }

  const db = client.db(dbName);
  return db;
}

;

(async function startupDB() {
  console.log('Starting up---');
  const db = await makeDb();
  await db.collection('todos').createIndex({
    todo_name: 'text',
    priority: 'text'
  });
  console.log('Done');
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kYXRhLWFjZXNzL2luZGV4LnRzIl0sIm5hbWVzIjpbInJlcXVpcmUiLCJjb25maWciLCJkYk5hbWUiLCJwcm9jZXNzIiwiZW52IiwiREJfTkFNRSIsInVybCIsIkRCX1VSTF9MSVZFIiwiREJfTE9DQUxfVVJMIiwiY2xpZW50IiwiTW9uZ29DbGllbnQiLCJ1c2VOZXdVcmxQYXJzZXIiLCJ1c2VVbmlmaWVkVG9wb2xvZ3kiLCJtYWtlRGIiLCJpc0Nvbm5lY3RlZCIsImNvbm5lY3QiLCJkYiIsInN0YXJ0dXBEQiIsImNvbnNvbGUiLCJsb2ciLCJjb2xsZWN0aW9uIiwiY3JlYXRlSW5kZXgiLCJ0b2RvX25hbWUiLCJwcmlvcml0eSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBQSxPQUFPLENBQUMsUUFBRCxDQUFQLENBQWtCQyxNQUFsQjs7QUFFQSxNQUFNQyxNQUFNLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxPQUEzQjtBQUVBLE1BQU1DLEdBQUcsR0FBR0gsT0FBTyxDQUFDQyxHQUFSLENBQVlHLFdBQVosSUFBMkJKLE9BQU8sQ0FBQ0MsR0FBUixDQUFZSSxZQUFuRCxDLENBRUE7O0FBQ0EsTUFBTUMsTUFBTSxHQUFHLElBQUlDLG9CQUFKLENBQWdCSixHQUFoQixFQUFxQjtBQUNsQ0ssRUFBQUEsZUFBZSxFQUFFLElBRGlCO0FBRWxDQyxFQUFBQSxrQkFBa0IsRUFBRTtBQUZjLENBQXJCLENBQWY7O0FBS08sZUFBZUMsTUFBZixHQUF3QjtBQUM3QixNQUFJLENBQUNKLE1BQU0sQ0FBQ0ssV0FBUCxFQUFMLEVBQTJCO0FBQ3pCLFVBQU1MLE1BQU0sQ0FBQ00sT0FBUCxFQUFOO0FBQ0Q7O0FBQ0QsUUFBTUMsRUFBRSxHQUFHUCxNQUFNLENBQUNPLEVBQVAsQ0FBVWQsTUFBVixDQUFYO0FBQ0EsU0FBT2MsRUFBUDtBQUNEOztBQUVEOztBQUFDLENBQUMsZUFBZUMsU0FBZixHQUEyQjtBQUMzQkMsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksZ0JBQVo7QUFDQSxRQUFNSCxFQUFFLEdBQUcsTUFBTUgsTUFBTSxFQUF2QjtBQUNBLFFBQU1HLEVBQUUsQ0FBQ0ksVUFBSCxDQUFjLE9BQWQsRUFBdUJDLFdBQXZCLENBQW1DO0FBQUVDLElBQUFBLFNBQVMsRUFBRSxNQUFiO0FBQXFCQyxJQUFBQSxRQUFRLEVBQUU7QUFBL0IsR0FBbkMsQ0FBTjtBQUNBTCxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxNQUFaO0FBQ0QsQ0FMQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE1vbmdvQ2xpZW50IH0gZnJvbSAnbW9uZ29kYidcbnJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpXG5cbmNvbnN0IGRiTmFtZSA9IHByb2Nlc3MuZW52LkRCX05BTUVcblxuY29uc3QgdXJsID0gcHJvY2Vzcy5lbnYuREJfVVJMX0xJVkUgfHwgcHJvY2Vzcy5lbnYuREJfTE9DQUxfVVJMXG5cbi8vIEB0cy1pZ25vcmVcbmNvbnN0IGNsaWVudCA9IG5ldyBNb25nb0NsaWVudCh1cmwsIHtcbiAgdXNlTmV3VXJsUGFyc2VyOiB0cnVlLFxuICB1c2VVbmlmaWVkVG9wb2xvZ3k6IHRydWUsXG59KVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWFrZURiKCkge1xuICBpZiAoIWNsaWVudC5pc0Nvbm5lY3RlZCgpKSB7XG4gICAgYXdhaXQgY2xpZW50LmNvbm5lY3QoKVxuICB9XG4gIGNvbnN0IGRiID0gY2xpZW50LmRiKGRiTmFtZSlcbiAgcmV0dXJuIGRiXG59XG5cbjsoYXN5bmMgZnVuY3Rpb24gc3RhcnR1cERCKCkge1xuICBjb25zb2xlLmxvZygnU3RhcnRpbmcgdXAtLS0nKVxuICBjb25zdCBkYiA9IGF3YWl0IG1ha2VEYigpXG4gIGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3RvZG9zJykuY3JlYXRlSW5kZXgoeyB0b2RvX25hbWU6ICd0ZXh0JywgcHJpb3JpdHk6ICd0ZXh0JyB9KVxuICBjb25zb2xlLmxvZygnRG9uZScpXG59KSgpXG4iXX0=