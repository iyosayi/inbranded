"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

const makeExpressCallback = controller => {
  return (req, res) => {
    const httpRequest = {
      body: req.body,
      params: req.params,
      query: req.query,
      ip: req.ip,
      file: req.file,
      method: req.method,
      path: req.path,
      user: req.user,
      headers: {
        'Content-Type': req.get('Content-Type'),
        Referer: req.get('referer')
      }
    };
    controller(httpRequest).then(httpResponse => {
      if (httpResponse.headers) {
        res.set(httpResponse.headers);
      }

      res.type('json');
      httpResponse.redirect ? res.redirect(httpResponse.redirect) : res.status(httpResponse.statusCode).send(httpResponse.data);
    }).catch(e => res.sendStatus(e.statusCode || 500).send(e.message));
  };
};

var _default = makeExpressCallback;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9leHByZXNzL2luZGV4LnRzIl0sIm5hbWVzIjpbIm1ha2VFeHByZXNzQ2FsbGJhY2siLCJjb250cm9sbGVyIiwicmVxIiwicmVzIiwiaHR0cFJlcXVlc3QiLCJib2R5IiwicGFyYW1zIiwicXVlcnkiLCJpcCIsImZpbGUiLCJtZXRob2QiLCJwYXRoIiwidXNlciIsImhlYWRlcnMiLCJnZXQiLCJSZWZlcmVyIiwidGhlbiIsImh0dHBSZXNwb25zZSIsInNldCIsInR5cGUiLCJyZWRpcmVjdCIsInN0YXR1cyIsInN0YXR1c0NvZGUiLCJzZW5kIiwiZGF0YSIsImNhdGNoIiwiZSIsInNlbmRTdGF0dXMiLCJtZXNzYWdlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBRUEsTUFBTUEsbUJBQW1CLEdBQUlDLFVBQUQsSUFBMEI7QUFDcEQsU0FBTyxDQUFDQyxHQUFELEVBQVdDLEdBQVgsS0FBNkI7QUFDbEMsVUFBTUMsV0FBVyxHQUFHO0FBQ2xCQyxNQUFBQSxJQUFJLEVBQUVILEdBQUcsQ0FBQ0csSUFEUTtBQUVsQkMsTUFBQUEsTUFBTSxFQUFFSixHQUFHLENBQUNJLE1BRk07QUFHbEJDLE1BQUFBLEtBQUssRUFBRUwsR0FBRyxDQUFDSyxLQUhPO0FBSWxCQyxNQUFBQSxFQUFFLEVBQUVOLEdBQUcsQ0FBQ00sRUFKVTtBQUtsQkMsTUFBQUEsSUFBSSxFQUFFUCxHQUFHLENBQUNPLElBTFE7QUFNbEJDLE1BQUFBLE1BQU0sRUFBRVIsR0FBRyxDQUFDUSxNQU5NO0FBT2xCQyxNQUFBQSxJQUFJLEVBQUVULEdBQUcsQ0FBQ1MsSUFQUTtBQVFsQkMsTUFBQUEsSUFBSSxFQUFFVixHQUFHLENBQUNVLElBUlE7QUFTbEJDLE1BQUFBLE9BQU8sRUFBRTtBQUNQLHdCQUFnQlgsR0FBRyxDQUFDWSxHQUFKLENBQVEsY0FBUixDQURUO0FBRVBDLFFBQUFBLE9BQU8sRUFBRWIsR0FBRyxDQUFDWSxHQUFKLENBQVEsU0FBUjtBQUZGO0FBVFMsS0FBcEI7QUFjQWIsSUFBQUEsVUFBVSxDQUFDRyxXQUFELENBQVYsQ0FDR1ksSUFESCxDQUNTQyxZQUFELElBQXVCO0FBQzNCLFVBQUlBLFlBQVksQ0FBQ0osT0FBakIsRUFBMEI7QUFDeEJWLFFBQUFBLEdBQUcsQ0FBQ2UsR0FBSixDQUFRRCxZQUFZLENBQUNKLE9BQXJCO0FBQ0Q7O0FBRURWLE1BQUFBLEdBQUcsQ0FBQ2dCLElBQUosQ0FBUyxNQUFUO0FBQ0FGLE1BQUFBLFlBQVksQ0FBQ0csUUFBYixHQUNJakIsR0FBRyxDQUFDaUIsUUFBSixDQUFhSCxZQUFZLENBQUNHLFFBQTFCLENBREosR0FFSWpCLEdBQUcsQ0FBQ2tCLE1BQUosQ0FBV0osWUFBWSxDQUFDSyxVQUF4QixFQUFvQ0MsSUFBcEMsQ0FBeUNOLFlBQVksQ0FBQ08sSUFBdEQsQ0FGSjtBQUdELEtBVkgsRUFXR0MsS0FYSCxDQVdVQyxDQUFELElBQVl2QixHQUFHLENBQUN3QixVQUFKLENBQWVELENBQUMsQ0FBQ0osVUFBRixJQUFnQixHQUEvQixFQUFvQ0MsSUFBcEMsQ0FBeUNHLENBQUMsQ0FBQ0UsT0FBM0MsQ0FYckI7QUFZRCxHQTNCRDtBQTRCRCxDQTdCRDs7ZUErQmU1QixtQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJlc3BvbnNlIH0gZnJvbSAnZXhwcmVzcydcblxuY29uc3QgbWFrZUV4cHJlc3NDYWxsYmFjayA9IChjb250cm9sbGVyOiBGdW5jdGlvbikgPT4ge1xuICByZXR1cm4gKHJlcTogYW55LCByZXM6IFJlc3BvbnNlKSA9PiB7XG4gICAgY29uc3QgaHR0cFJlcXVlc3QgPSB7XG4gICAgICBib2R5OiByZXEuYm9keSxcbiAgICAgIHBhcmFtczogcmVxLnBhcmFtcyxcbiAgICAgIHF1ZXJ5OiByZXEucXVlcnksXG4gICAgICBpcDogcmVxLmlwLFxuICAgICAgZmlsZTogcmVxLmZpbGUsXG4gICAgICBtZXRob2Q6IHJlcS5tZXRob2QsXG4gICAgICBwYXRoOiByZXEucGF0aCxcbiAgICAgIHVzZXI6IHJlcS51c2VyLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogcmVxLmdldCgnQ29udGVudC1UeXBlJyksXG4gICAgICAgIFJlZmVyZXI6IHJlcS5nZXQoJ3JlZmVyZXInKSxcbiAgICAgIH0sXG4gICAgfVxuICAgIGNvbnRyb2xsZXIoaHR0cFJlcXVlc3QpXG4gICAgICAudGhlbigoaHR0cFJlc3BvbnNlOiBhbnkpID0+IHtcbiAgICAgICAgaWYgKGh0dHBSZXNwb25zZS5oZWFkZXJzKSB7XG4gICAgICAgICAgcmVzLnNldChodHRwUmVzcG9uc2UuaGVhZGVycylcbiAgICAgICAgfVxuXG4gICAgICAgIHJlcy50eXBlKCdqc29uJylcbiAgICAgICAgaHR0cFJlc3BvbnNlLnJlZGlyZWN0XG4gICAgICAgICAgPyByZXMucmVkaXJlY3QoaHR0cFJlc3BvbnNlLnJlZGlyZWN0KVxuICAgICAgICAgIDogcmVzLnN0YXR1cyhodHRwUmVzcG9uc2Uuc3RhdHVzQ29kZSkuc2VuZChodHRwUmVzcG9uc2UuZGF0YSlcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGU6IGFueSkgPT4gcmVzLnNlbmRTdGF0dXMoZS5zdGF0dXNDb2RlIHx8IDUwMCkuc2VuZChlLm1lc3NhZ2UpKVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IG1ha2VFeHByZXNzQ2FsbGJhY2tcbiJdfQ==